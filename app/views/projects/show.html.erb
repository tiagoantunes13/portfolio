<% content_for :meta_title, "#{@project.title} | Tiago Antunes" %>
<% content_for :meta_description, @project.description.truncate(155) %>
<% if @project.primary_image.present? %>
  <% content_for :meta_image, url_for(@project.primary_image) %>
<% end %>
<% content_for :meta_url, project_url(@project) %>

<% content_for :head do %>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareSourceCode",
    "name": "<%= @project.title %>",
    "description": "<%= @project.description.gsub('"', '\"') %>",
    "author": {
      "@type": "Person",
      "name": "Tiago Antunes",
      "url": "<%= root_url %>"
    },
    <% if @project.project_url.present? %>
    "url": "<%= @project.project_url %>",
    <% end %>
    <% if @project.github_url.present? %>
    "codeRepository": "<%= @project.github_url %>",
    <% end %>
    <% if @project.technologies.present? %>
    "programmingLanguage": "<%= @project.technologies.split(',').first.strip %>",
    <% end %>
    <% if @project.primary_image.present? %>
    "image": "<%= url_for(@project.primary_image) %>",
    <% end %>
    "dateCreated": "<%= @project.created_at.iso8601 %>"
  }
  </script>
<% end %>

<main class="flex-grow">
  <!-- Hero Section -->
  <div class="@container px-4 sm:px-8 md:px-20 lg:px-40 py-10 md:py-20">
    <div class="flex flex-col gap-6 max-w-4xl mx-auto">
      <!-- Back Navigation -->
      <div>
        <%= link_to projects_path, class: "inline-flex items-center gap-2 text-primary hover:text-accent-secondary text-sm font-medium transition-colors" do %>
          <span>←</span>
          <span>cd ../projects/</span>
        <% end %>
      </div>

      <!-- Project Header -->
      <div class="flex flex-col gap-3">
        <h1 class="text-white text-4xl font-black leading-tight tracking-[-0.033em] @[480px]:text-5xl">
          <%= @project.title %>
        </h1>
        <% if @project.role.present? %>
          <p class="text-primary text-sm font-medium font-mono">
            --role="<%= @project.role %>"
          </p>
        <% end %>
      </div>

      <!-- Technologies -->
      <% if @project.technologies.present? %>
        <div class="flex flex-wrap gap-2">
          <% @project.technologies.split(',').each do |tech| %>
            <span class="bg-primary/10 text-primary px-3 py-1 rounded text-sm font-mono border border-primary/20">
              <%= tech.strip %>
            </span>
          <% end %>
        </div>
      <% end %>

      <!-- Action Buttons -->
      <div class="flex flex-wrap gap-3">
        <% if @project.project_url.present? %>
          <%= link_to @project.project_url, target: "_blank", rel: "noopener noreferrer", class: "flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded h-10 px-4 @[480px]:h-12 @[480px]:px-5 bg-primary text-background-dark text-sm font-bold leading-normal tracking-[0.015em] @[480px]:text-base hover:bg-accent-secondary hover:text-white transition-colors" do %>
            <span class="truncate">View Live Demo →</span>
          <% end %>
        <% end %>
        <% if @project.github_url.present? %>
          <%= link_to @project.github_url, target: "_blank", rel: "noopener noreferrer", class: "flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded h-10 px-4 @[480px]:h-12 @[480px]:px-5 bg-white/10 text-white text-sm font-bold leading-normal tracking-[0.015em] @[480px]:text-base hover:bg-white/20 transition-colors" do %>
            <span class="truncate">View Source Code</span>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Primary Image -->
  <% if @project.primary_image.present? %>
    <div class="px-4 sm:px-8 md:px-20 lg:px-40 pb-10">
      <div class="max-w-[900px] mx-auto rounded-lg overflow-hidden">
        <%= image_tag @project.primary_image, class: "w-full h-auto", alt: "#{@project.title} screenshot" %>
      </div>
    </div>
  <% end %>

  <!-- Description Section -->
  <div class="px-4 sm:px-8 md:px-20 lg:px-40 pb-10">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-primary text-lg sm:text-xl md:text-[22px] font-bold leading-tight tracking-[-0.015em] pb-3">
        cat README.md
      </h2>
      <div class="bg-black/20 p-4 sm:p-6 rounded-lg border border-primary/20">
        <p class="text-white/80 font-mono text-xs sm:text-sm leading-relaxed whitespace-pre-wrap"><%= @project.description %></p>
      </div>
    </div>
  </div>

  <!-- Key Features Section -->
  <% if @project.key_features.present? %>
    <div class="px-4 sm:px-8 md:px-20 lg:px-40 pb-10">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-primary text-lg sm:text-xl md:text-[22px] font-bold leading-tight tracking-[-0.015em] pb-3">
          cat features.txt
        </h2>
        <div class="bg-black/20 p-4 sm:p-6 rounded-lg border border-primary/20">
          <div class="text-white/80 font-mono text-xs sm:text-sm leading-relaxed space-y-2">
            <% @project.key_features.split("\n").reject(&:blank?).each do |feature| %>
              <div class="flex gap-2">
                <span class="text-primary">•</span>
                <span><%= feature.strip %></span>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Highlights/Outcomes Section -->
  <% if @project.highlights.present? %>
    <div class="px-4 sm:px-8 md:px-20 lg:px-40 pb-10">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-primary text-lg sm:text-xl md:text-[22px] font-bold leading-tight tracking-[-0.015em] pb-3">
          cat outcomes.log
        </h2>
        <div class="bg-black/20 p-4 sm:p-6 rounded-lg border border-primary/20">
          <p class="text-white/80 font-mono text-xs sm:text-sm leading-relaxed whitespace-pre-wrap"><%= @project.highlights %></p>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Image Gallery -->
  <% if @project.images.count > 1 %>
    <div class="px-4 sm:px-8 md:px-20 lg:px-40 pb-10">
      <div class="max-w-[900px] mx-auto">
        <h2 class="text-primary text-lg sm:text-xl md:text-[22px] font-bold leading-tight tracking-[-0.015em] pb-3">
          ls screenshots/
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <% @project.images.drop(1).each do |image| %>
            <div class="w-full rounded-lg overflow-hidden">
              <%= image_tag image, class: "w-full h-auto", alt: "#{@project.title} screenshot" %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Footer Navigation -->
  <div class="px-4 sm:px-8 md:px-20 lg:px-40 pb-20">
    <div class="max-w-4xl mx-auto flex justify-between items-center pt-10 border-t border-primary/20">
      <%= link_to projects_path, class: "inline-flex items-center gap-2 text-primary hover:text-accent-secondary text-sm font-medium transition-colors" do %>
        <span>←</span>
        <span>Back to All Projects</span>
      <% end %>
      <%= link_to contact_path, class: "flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded h-10 px-4 bg-primary text-background-dark text-sm font-bold leading-normal tracking-[0.015em] hover:bg-accent-secondary hover:text-white transition-colors" do %>
        <span class="truncate">Get In Touch</span>
      <% end %>
    </div>
  </div>
</main>
